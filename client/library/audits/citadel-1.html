<page
  clientName="Citadel"
  reportDate="December 2nd, 2022"
  auditTitle="Citadel A-1"
  auditVersion="1.0.0"
  repoUrl="https://github.com/thecitadelgame/contracts"
  passwordEncrypt="env:PAGE_PASS_CITADEL_1"
  layout="/library/audits/_layout.html"
  customRepoInfo
  customReviewInfo
>
  <content-for name="schedule">
    The security audit was performed by the Macro security team from September
    5, 2022 to November 12, 2022.
  </content-for>

  <content-for name="spec">
    <ul>
      <li>{{page.clientName}} whitepaper and yellowpaper.</li>
      <li>Discussions on Telegram with the {{page.clientName}} team.</li>
      <li>Internal documents shared by {{page.clientName}} team.</li>
    </ul>
  </content-for>

  <content-for name="repo-info">
    <ul>
      <li>
        <b>Repository:</b>
        <a href="{{page.repoUrl}}" target="_blank">
          {{page.repoUrl.split('/').slice(-1)[0]}}
        </a>
      </li>
      <li class="break-words break-all">
        Commit Hash <b>(Main Contracts):</b>
        <code>bc0a02a32b2f24b3d354b1c7a9d26c2018c906fd</code>
      </li>
      <li class="break-words break-all">
        Commit Hash <b>(ZK ConstructionBay):</b>
        <code>7ecdce4b38ce7e2bd416dabb7894e2f91fe549c1</code>
      </li>
      <li class="break-words break-all">
        Commit Hash <b>(Deployment Scripts):</b>
        <code>a1e556d4abb9d9662a9f825b7103b8a77f57cee0</code>
      </li>
    </ul>
  </content-for>


  <content-for name="source-code">

    <p>Specifically, we audited the following contracts as part of the main audit:</p>
  
    <template type="file-hashes">
      834be0f6545fff11a6f1c9cb7846f8faf4ccf9a27c004413d73459ed7c4e85ed  contracts/Migrations.sol
      a2205ed9c7e42de550317c0fd5b6c4ae2f64aa85c2b9552185de124463bc0807  contracts/bridging/BaseChildTunnel.sol
      b4b95b5dd84d46fe637ea412e9c055f3f898e1cb0c0654a5625957dc7ee25a42  contracts/bridging/BaseRootTunnel.sol
      c5161e19f99d6331bd7814a73b66891e84c642ae34153cf0c8445ccdc7b3145e  contracts/bridging/BaseRootTunnelMock.sol
      6f33bdd8a428e62a86707e37b49e23edcfd0565651b36a481c4e62c227a12ff9  contracts/bridging/Dock.sol
      3e736ef5140b0c626fc58bcd07026d5ac871b8b4fe1c9a250fc3592699311980  contracts/bridging/GovernanceChildTunnel.sol
      b8f65180782a1e130019571799a3108cffa2057b0ca4f6a04813f33a8e4fade7  contracts/bridging/GovernanceRootTunnel.sol
      26904b0453d682491b09436b786fe1f9f909f2c1373f8be6b27ca6885cfdfbc8  contracts/bridging/GovernanceRootTunnelMock.sol
      caf8ad3fafa71d31a1a9a43ce3a009752d9c3df14b66ed34e659027d716b317c  contracts/bridging/StandardChildTunnel.sol
      a288bdabe60b1c49a0be7ec754f12946805a89e373fe142694eb8cdc9ab18a5d  contracts/bridging/StandardRootTunnel.sol
      e4b851ed961b68ce7a8c133d15377750923dc88bd3111a66e880fbd468b0aa48  contracts/bridging/StandardRootTunnelMock.sol
      cd443a4a741ed1f80344fcf59689f12d932a81954aea7872a69655f4a36ab721  contracts/construction/ConstructionBay.sol
      71fcb5af1e68909f0d26917e68cef5b1aafd8bc68142c5e73cacba4597a682ab  contracts/finance/CitadelPaymentSplitter.sol
      b87e44ba2770ca369de8098885b30d78260d55ac573eeacf04abca48855d33d6  contracts/fx/FxChildMock.sol
      4c4abf29efc9e47defbc57e27e55c76ff3684d0e412c7c2632c988d0f7c92109  contracts/fx/FxRootMock.sol
      624288703e467b956f7c04e0aaf6b97d538eca8d888f67f7a7ffe66468c0eb91  contracts/fx/lib/ExitPayloadReader.sol
      ecc7cd00047388c0f2612b8086f457162b2d99d93c6141447e4682008fd6324e  contracts/fx/lib/Merkle.sol
      5086800b71b49202d05b54984e4a0970dbbff8aef6e62e77b9a63755a96e56a1  contracts/fx/lib/MerklePatriciaProof.sol
      b700843f24e26dea92ba70c9748a305355dcf5a5f08b9adb65b0f57fe4f0c653  contracts/fx/lib/RLPReader.sol
      1e80c9d91361c1fba458c4f8302c59ea4ab108ca49fb00b2f8ebad13e008af2f  contracts/fx/tunnel/FxBaseChildTunnel.sol
      13e41b33a1c03ffcab1ab91d2e0598d636e4436838fdc8ff5d5d00b68e8a828a  contracts/fx/tunnel/FxBaseRootTunnel.sol
      e51994cb8fb51b929063f8f3c09152e31cafcd3a315809bc16676da3cf2f2139  contracts/game/Belts.sol
      89c10b4e41881a8ef762fbdcbd999c694a089cd0862fbee1f0ce58fa24eb7a75  contracts/game/BeltsLib.sol
      52acb1986a754cf0e5084582c313654b12fe78de9783045816125ddc294cbf00  contracts/game/Game.sol
      809539b22ad1c06bfef8978690b59f0a9108a1609864b6be28e2e2a667544d82  contracts/game/Outposts.sol
      2674953b6930a6dfe21656fbf44795be231d63db6beb5e4e2c39c8080d33112f  contracts/game/OutpostsLib.sol
      61264dd212f59c106d27e62cbce16fd5395b70a566cf798dab2eff6aae25a594  contracts/game/Rewards.sol
      e3c3860ded7e3ff2e287cdabd3422754efe6a8375c2b8b83d80cf2d4cf3c8434  contracts/game/RewardsLib.sol
      c5aa6f08306e2a668a64119b959874afe12a2384617717fa8ef2ec41bd0b6b9b  contracts/game/Staking.sol
      3667f036e4dc978ddec9cb62690d40362ed065b1270e9568204464e931005c30  contracts/game/TokenTraits.sol
      3d844cd042efeaca67a884a0972b390af72733da1aefcfc5994c24f0b38289d2  contracts/game/Travel.sol
      f37677edd619126d73e555a0794168a74b7dc6bdae5a24ebe75776b77083a9e7  contracts/game/TravelLib.sol
      64875fdbc974dde047868819c7d63eb1c8daafe9c556df8e741759f52f5269fd  contracts/game/Upgrades.sol
      fb961583ac937e2f050d0e94911c0ec61b3e1244b6e4a4a447d03052625871d2  contracts/game/UpgradesCalculator.sol
      28a0773cca46da481a14263eedc58fc697150069ce6894e4d50125f8afc56df0  contracts/game/UpgradesCalculatorLib.sol
      efa86ca6aca76c7749e834cad04849959aade5776c376391a3c05fa0a54ff95b  contracts/game/UpgradesLib.sol
      292e648abe7839300d60d7d88d4a4bd85ee7c2d083b3c215ffe4b6283b8463ca  contracts/governance/CitadelGovernor.sol
      37a05a9092c840a40161c162043fa03fb3f3b3b3faf7ebfc5916d38d30f2dbca  contracts/governance/CitadelTimelock.sol
      5864e47c9e698de36d3918aadb676c2840af0b440e94c0863f1f76231e031fbe  contracts/governance/GovernanceTokenMock.sol
      fb550a338688809ded088b8cedf7808d1ef0b7aa646f06a814142ffbb36ed1e0  contracts/interfaces/IBeltsLib.sol
      5d1544037f163c1d3a999ad91bcdbf9f489487d313e1e18a5bf28fda93c957a9  contracts/interfaces/IConstructionBay.sol
      d567b4af0c9d1c78a2c2c5e29ea68e7e61377dc6b375c50c18c4caea54f4d39d  contracts/interfaces/IERC20Burnable.sol
      82335157c0e2704ac500cea28dfc1ff4cd473c5eeb605803b7a67f9e07fe322d  contracts/interfaces/IGameEvents.sol
      1d7164f199c7edf05c1852cd32b77c1b067ed0e366f7780cf3024321c8f38882  contracts/interfaces/IMetadataLib.sol
      664dbaa6e9441fd637d95bbe34325ad1a7057681f684ca49444b08e8bc9ae84e  contracts/interfaces/IOre.sol
      45fe77a3c67100a5808ec072a5725ca5f33056563288faaf056d00c81b940687  contracts/interfaces/IOutpostsLib.sol
      a88474279a02fd6156abe00bbe4e5926f2d284a89cf42b59ce427104a00d9465  contracts/interfaces/IPilotBadge.sol
      dad4566641fdc54baf6ca0df4d7c3ec09da21e45170446ca3e65be7bfe847167  contracts/interfaces/IProxyRegistry.sol
      c71a32f78f9bc4b974671a9375cd73824c641d7c620a15ed50b8e2ef6128e60c  contracts/interfaces/IRandomOracle.sol
      10444a1209e641f12a397b18d9d97c484d9653c3145a69a9769112ae7f906968  contracts/interfaces/IRewardsLib.sol
      591a13d39dd9ba6f3b1e592dbcbcf8132837581e97c7ff1494e5cc849e6641f8  contracts/interfaces/IShipTraits.sol
      d2494fb0ed00edcc7c469c38d8b3478db3afd9449768f5d185272477bf881da8  contracts/interfaces/IShips.sol
      c9314212705fb1a31c58e9e0b471a4f576ccab95791862c77da76266b201f820  contracts/interfaces/IStructs.sol
      63c1b6bb1895f8bc52aeabc1c9e020d7afffa30fa50d3bdc1ed88809052b034f  contracts/interfaces/ITravelLib.sol
      dad64f71c129a395b55cd9b44869836e0fb116da7ce3849e5948b4b319892e7b  contracts/interfaces/ITunnel.sol
      822e0aa75e8ba5693bab3f44b5ecd3f43245cf38e37c65393626604b34809914  contracts/interfaces/IUpgradesCalculatorLib.sol
      6f70ace6eb4a95d5f3417e0f15aeecf2036f42cf87cc1862ccaeb2babf58f477  contracts/interfaces/IUpgradesLib.sol
      1cfc559ebea2e8254e9877a008f72381ebf1f4fc7fc7b221266e9dfe18b0567f  contracts/oracles/RandomOracle.sol
      30087892c16c59fc4adc7cea158bff3ae042565c2275d5911b00f9474129b806  contracts/oracles/RandomOracleConsumer.sol
      e37c18280a7b73001be943f9bf74fb38102e42f4d001f085faa6635d61a06410  contracts/oracles/RandomOracleConsumerMock.sol
      0b6ec9cc92e461f78dfce5d145de6031db4a76a9c29cd1d7e7aa6c8e1ecb7ac7  contracts/oracles/RandomOracleMock.sol
      975f96c448ea3e14d3a9c86ce4f0fbf663a76ad73cfb822db75a71fe706c5563  contracts/proxy/CitadelProxyAdmin.sol
      2ec505a5b63dd2c97999e7ff91856458b6a074819680296b84cdda9a4122e5f7  contracts/proxy/TransparentUpgradeableProxyMock.sol
      180c91624339786c236845bc6bf9fb4850ee6ead13242a49211ebff8c6786001  contracts/proxy/UpgradeableMockV1.sol
      36c303f01782bcf18316a0d9a752084f9f347b8d872c69c4e0f541421dd0ccb8  contracts/proxy/UpgradeableMockV2.sol
      15ab96fd68187383147989082c77eb00d3618450be6a3fa8f9dd003199b671d5  contracts/token/BaseShipTraits.sol
      3266d495a898f5113c6b31d6b50278ac26145301625961f483d2558dcad93c1e  contracts/token/BaseShips.sol
      29c9c211c9416029953b49f6106df4c9c4e607fb5ec01d98420003b41aa94a3a  contracts/token/DutchAuctionShips.sol
      695c6d44f74ce3801d6f5b295cc7e8cae7b4d6ca196cd193190d716db3ee2d9c  contracts/token/ERC20Locked.sol
      6b7554d5091eaba27d713c30147e372ca9c1fc31a773c374497d22abfcdc0efc  contracts/token/ERC20LockedVotes.sol
      9837502605dab69830bccc708c6a7be52bfbdeece77634d053a7f7072e7c9eb6  contracts/token/ERC721C.sol
      bc2b64f00f723ee97983ae1ed70015fff032242a8f10fade0cdf4cdc2b2d795e  contracts/token/FixedPriceShips.sol
      357878c29a3be4b0e210c1a398d1bb8d309a89545de9ba93e56b54b51ffd4992  contracts/token/FixedShipTraits.sol
      9db8159a7a0ad011f42617233c684451a58703dde411c59ea682c735e505f8ef  contracts/token/GenesisShipTraits.sol
      34f6e30b47ed22bb28a986f97ed217e2ce29b53b35caef16d04ebf81c6b749ef  contracts/token/MetadataLib.sol
      d49ccecfa214ecc0ac62439287b21e74bd96d5d2786ae95438618b0b3de4b414  contracts/token/Ore.sol
      8bbf66d5b4794012fb0bbbb6d0f6cc1556a7410136668686b2017f2e60200973  contracts/token/PilotBadge.sol
      c06c25851d4deb2ea3d5463a2c161c114a328e1678a8f7b9066f779b2a03cd14  contracts/token/ProxyRegistryMock.sol
      71f4ef7c7c100ca5a4329d6945e6933cb0015fcce0946e1266abe913aa6f27b0  contracts/token/ShipsMock.sol
      9c49d3ee872f8e27866d4086124ca38989d2f41bcb9286af8aa77b0072b27d40  contracts/util/Bytes32Strings.sol
      a52603f725839259b0503864ffb8531bfe116c031dda556830e7860742350db7  contracts/util/TokenContracts.sol
    </template>
  
  
    <p>We audited the following contracts and circuits as part of zero-knowladge implementation of Construction Bay:</p>
  
    <template type="file-hashes">
      4096fb22fba84ff0d905df3612dd3f3e0c9abf2b2457ef1db9f13e4bf5047894  contracts/construction/ConstructionBay.sol
      0c4cb761a86912e5da5963e0207f93b6854e46542b69b6f86c9a0d4715a4e3f7  contracts/construction/RedBlackTreeLib.sol
      8b5c03f64cdbad0ce999e17ffbc14003307b3518d05230165a6136e314f9cd86  contracts/interfaces/IConstructionBay.sol
      e566e282f17cc2354dd5b82a1debb709080ab30f4b26bf1ca16c65cd18f13028  contracts/verifiers/CommitVerifier.sol
      b2f1b90a47d58d3de8106e4d865fea15eae94c4d316cd069e44f9fc6b6573ad3  contracts/verifiers/RevealVerifier.sol
      f746ab1bfe47af14f05ea3c0743a871ceec55acf4a5d493fa34ec756998156f2  circuits/bid_ticket_hasher.circom
      61fd7ca75fd17feb3a98f9bc9d6ae2d8a6501d037b145eca3881474b0fb9c8e8  circuits/commit.circom
      75f1ee8f7e6a6452aefcce3352fe9b27d83180fd10fb6c737096d92d2ab2467e  circuits/reveal.circom
    </template>

    <p>We also reviewed following deployment scripts:</p>
  
    <template type="file-hashes">
      77b1cd797049373196a379f3cc406f94f81b72f7d754e8a3974c6bb7fee4d943  migrations/1_initial_migration.js
      997a832c4b2602a9ae4b1633d3a7965799f3d053dce6ddba48dd5a621ac77850  migrations/2_deploy_fx.js
      8567eb5d9df28e1778d87e8427884f5333d384c1094ab98dcf5785806506526e  migrations/3_deploy_contracts.js
      dabc9930380a33f893477d990de6d03f7d43d2c45ad32cb351ca56f1ab66bd15  migrations/4_enable_communication.js
      f2cbb2e88f25c5d861121e7a09ec2add781511d715165d27cc889832d89dd849  migrations/5_relinquish_to_governance.js
      ef391bdaf0e552f842d7ec56727d909eb8d9f32a337190177ea8c582d7f8e3bc  citadel-config.js
    </template>
  
  </content-for>

</page>
