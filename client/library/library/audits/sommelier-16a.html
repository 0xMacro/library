<page
  clientName="Sommelier"
  reportDate="January 22, 2024"
  auditTitle="Sommelier A-16a"
  auditVersion="1.0.0"
  repoUrl="https://github.com/PeggyJV/cellar-contracts"
  layout="/library/audits/_layout.html" 
  repoCommitHash="59e723a2b5f39bc314e4597887cb68a03640224b"
  repoCommitHashFinal="39de84c941880c7a340643b674eceeb18a6c9242"
  passwordEncrypt="env:PAGE_PASS_SOMMELIER"
>
  <content-for name="schedule">
    The security audit was performed by the Macro security team from January 15, 2024 to January 22, 2023.
  </content-for>

  <content-for name="spec">
    <ul>
      <li>Discussions with the {{page.clientName}} team.</li>
      <li>Available documentation in the repository.</li>
    </ul>
    <h2 id="tmaar">Trust Model, Assumptions, and Accepted Risks (TMAAR)</h2>
    <template type="audit-markdown">
        ### Trusted entities:

        - Strategists:
            - User that can manage positions in the cellar. Is trusted to act in the benefit of the cellars shareholders, and earns a portion of the cellars profits. All actions made by the strategist are approved by Sommelier governance. Has the ability to shutdown the cellar in case of an emergency.
        - Governance:
            - Sommelier governance responsible for approving strategist actions, as well as adding or removing trusted positions for cellars.
        - Multisig:
            - Approves adaptors and positions in the registry as well as adding and updating price feeds for assets in the priceRouter. Can pause cellars, which can be unpaused by governance.
        - Chainlink:
            - Responsible for a majority of pricing, as well as running automated tasks for share price oracles. It is trusted that the data it provides is correct.
  
        The goal of the system is to to have checks and balances for each permissioned action, where if any one permissioned entity acts malicious, the others can remedy the situation, requiring multiple points failure before it can negatively impact users.
  
        ### Assumptions:
  
        - There is an assumption that permissioned entities will not act maliciously.
        - It is assumed that the protocols that a cellar interacts with wont act maliciously, and will operate as intended.
  
        ### Accepted Risks:
  
        - Share price varies based on market conditions, and there is no guarantee share price will increase.
        - Protocols that a cellar interacts with could be exploited. There are ways trusted entities can help mitigate the effect of such exploits, but there may be a negative effect on share price and a loss of funds for users.
   
    </template>
  </content-for>

  <content-for name="source-code">
    <p>
      Specifically, we audited the following contracts within this repository.
    </p>

    <template type="file-hashes">
        6967e427be04533ee4456ac796a91b408ede61fc63cfddf2c1f2226693036fc9  src/base/Cellar.sol
        e482ad2938ad4e283470f9f83d2b9f9ccb0a4dd474d4c8024dae34a86aef3d78  src/base/permutations/CellarWithMultiAssetDeposit.sol
        e88a29520db83cd1b820ee334bac8ab17e6c0ccead850563a02bbe05b370717b  src/base/permutations/CellarWithNativeSupport.sol
        bc48a55e176a0e51832e0ba7805c95b3e2b3380c9bfa950897b7fd7c3d2f077f  src/modules/adaptors/Morpho/MorphoBlue/MorphoBlueCollateralAdaptor.sol
        cb2373e057d9b8b356f4d23baab1c381a96dd1ca968f91ace4da967547804501  src/modules/adaptors/Morpho/MorphoBlue/MorphoBlueDebtAdaptor.sol
        c7a5fb7654e969ff054bba7cdfe49e69d1905cdfb222395c2bbb822ad23ba0e6  src/modules/adaptors/Morpho/MorphoBlue/MorphoBlueHelperLogic.sol
        cb67f9da166123357c54709477599460532b8a228de8a55b3add6135e5e2c290  src/modules/adaptors/Morpho/MorphoBlue/MorphoBlueSupplyAdaptor.sol
        0957274d973e48c9046f817b05c4405ae72884c1c8f8834b43a3b1764282a6f4  src/base/permutations/advanced/CellarWithOracleWithBalancerFlashLoansWithMultiAssetDeposit.sol
        60465233b95b4be8fb0af375de79ed42d1e126b57a67fe3d92aceb829919abaa  src/base/permutations/advanced/CellarWithOracleWithBalancerFlashLoansWithMultiAssetDepositWithNativeSupport.sol
    </template>

  </content-for>
</page>
