<page
  clientName="Sommelier"
  reportDate="January 22, 2023"
  auditTitle="Sommelier A-15"
  auditVersion="1.0.0"
  repoUrl="https://github.com/PeggyJV/cellar-contracts"
  layout="/library/audits/_layout.html" 
  repoCommitHash="341fc1f49787de57143997da90762bbca23bd20d"
  repoCommitHashFinal="33320d36f03e9b50732ad9e695c3acb0a49970cc"
>
  <content-for name="schedule">
    The security audit was performed by the Macro security team on December 22, 2023.
  </content-for>

  <content-for name="spec">
    <ul>
      <li>Discussions with the {{page.clientName}} team.</li>
      <li>Available documentation in the repository.</li>
    </ul>
    <h2 id="tmaar">Trust Model, Assumptions, and Accepted Risks (TMAAR)</h2>
    <template type="audit-markdown">
      ### Trusted entities:

      - Strategists:
          - User that can manage positions in the cellar. Is trusted to act in the benefit of the cellars shareholders, and earns a portion of the cellars profits. All actions made by the strategist are approved by Sommelier governance. Has the ability to shutdown the cellar in case of an emergency.
      - Governance:
          - Sommelier governance responsible for approving strategist actions, as well as adding or removing trusted positions for cellars.
      - Multisig:
          - Approves adaptors and positions in the registry as well as adding and updating price feeds for assets in the priceRouter. Can pause cellars, which can be unpaused by governance.
      - Chainlink:
          - Responsible for a majority of pricing, as well as running automated tasks for share price oracles. It is trusted that the data it provides is correct.

      The goal of the system is to to have checks and balances for each permissioned action, where if any one permissioned entity acts malicious, the others can remedy the situation, requiring multiple points failure before it can negatively impact users.

      ### Assumptions:

      - There is an assumption that permissioned entities will not act maliciously.
      - It is assumed that the protocols that a cellar interacts with wont act maliciously, and will operate as intended.

      ### Accepted Risks:

      - Share price varies based on market conditions, and there is no guarantee share price will increase.
      - Protocols that a cellar interacts with could be exploited. There are ways trusted entities can help mitigate the effect of such exploits, but there may be a negative effect on share price and a loss of funds for users.
  </template>
  </content-for>

  <content-for name="source-code">
    <p>
      Specifically, we audited the following contracts within this repository.
    </p>

    <template type="file-hashes">
      d190cb417ddffbd595d377c2e686ad7bbebb42b6fe2d09f36b6d51341ac4e1a0  src/modules/price-router/PriceRouter.sol
      05b1bea1468249a719fb1afc34f679a86be95d4a287a4a3214f90d06ee91c373  src/modules/price-router/permutations/SequencerPriceRouter.sol
    </template>

  </content-for>
</page>
